### Как работает TLS — шаг за шагом (TLS Handshake)

**1. Client Hello**  
Браузер отправляет серверу:

- поддерживаемые версии TLS (например, TLS 1.3),
    
- список шифров (cipher suites),
    
- случайное число (nonce),
    
- домен (через SNI — Server Name Indication).
    

**2. Server Hello**  
Сервер отвечает:

- выбранной версией TLS и шифром,
    
- своим TLS-сертификатом (содержит публичный ключ и домен),
    
- случайным числом.
    

**3. Проверка сертификата**  
Браузер:

- проверяет, что сертификат выдан доверенным центром сертификации (CA),
    
- что срок действия не истёк,
    
- и что домен в сертификате соответствует запрошенному адресу.
    

**4. Обмен ключами**  
Стороны создают общий секретный ключ:

- в TLS 1.3 используется алгоритм Diffie–Hellman (обычно ECDHE),
    
- приватные ключи не передаются — генерируется общий ключ из открытых данных.
    

**5. Finished**  
Каждая сторона:

- подписывает и шифрует специальное сообщение «Finished»,
    
- подтверждая, что всё прошло успешно и данные теперь защищены.