— это механизм безопасности в веб-браузерах, который контролирует доступ к ресурсам (например, API, изображениям, шрифтам) на сервере с другого домена, отличного от того, с которого загружен веб-сайт. Он предотвращает несанкционированные запросы между разными источниками (origin), но позволяет серверам явно разрешать такие запросы.

CORS определяет, может ли JavaScript на сайте (например, https://example.com) запросить данные с другого домена (например, https://api.another.com). Без CORS браузер по умолчанию блокирует такие запросы из-за политики Same-Origin Policy (политика одного источника), которая разрешает запросы только в пределах одного домена.

### Основные CORS-заголовки
- `**Access-Control-Allow-Origin**:` Указывает, какие домены могут делать запросы. Например, https://example.com или * (для всех).
- `**Access-Control-Allow-Methods**`: Разрешённые методы (GET, POST, etc.).
- `**Access-Control-Allow-Headers**`: Разрешённые кастомные заголовки.
- `**Access-Control-Allow-Credentials**`: Разрешает отправку cookies или авторизационных заголовков (например, true).
- `**Access-Control-Max-Age**`: Сколько времени кэшировать результаты предварительного запроса.

## Последовательность взаимодействия
CORS работает по-разному для **простых запросов** и **сложных запросов**. 
##### Простой запрос:
1. Клиент инициирует запрос
2. Сторонний сервер получает запрос и, если поддерживает CORS, возвращает ответ с заголовком Access-Control-Allow-Origin.
3. Браузер проверяет CORS
	- Браузер сравнивает Origin запроса (https://your-site.com) с Access-Control-Allow-Origin в ответе.
	- Если Access-Control-Allow-Origin содержит https://your-site.com или звездочку, браузер передаёт ответ JavaScript, и код продолжает работу.
	- Если заголовок отсутствует или указан другой домен, браузер блокирует ответ, и JavaScript получает ошибку:
##### Сложный запрос
1. <font color="#6425d0">Клиент инициирует предварительный запрос</font> (preflight) с методом OPTIONS, чтобы проверить, разрешён ли основной запрос.
2. <font color="#6425d0">Сервер отвечает на предварительный запрос:</font> Сервер проверяет, разрешены ли указанный метод и заголовки для данного домена. Если разрешены, сервер возвращает ответ с заголовками:
	- `Access-Control-Allow-Origin `(разрешённый домен или звездочка).
	- `Access-Control-Allow-Methods` (список разрешённых методов, например, GET, POST, PUT).
	- `Access-Control-Allow-Headers` (список разрешённых кастомных заголовков).
	- Опционально `Access-Control-Max-Age` (время кэширования ответа в секундах).
	Если сервер не разрешает запрос, он либо не возвращает нужные заголовки, либо возвращает ошибку.
3. <font color="#6425d0">Браузер анализирует ответ на preflight</font>
	 - Браузер проверяет, совпадает ли `Access-Control-Allow-Origin` с доменом клиента.
    - Проверяет, включены ли метод и заголовки основного запроса в A`ccess-Control-Allow-Methods` и `Access-Control-Allow-Headers.`
    - Если всё разрешено, браузер переходит к отправке основного запроса.
    - Если нет, запрос блокируется, и JavaScript получает ошибку CORS.
4. <font color="#6425d0">Браузер отправляет основной запрос</font>
	- Если preflight успешен, браузер отправляет основной запрос (например, PUT) с указанным методом, заголовками и телом
5. <font color="#6425d0">Сервер отвечает на основной запрос</font>
	- Сервер выполняет запрос и возвращает данные, добавляя Access-Control-Allow-Origin (и другие CORS-заголовки, если нужно).
6. <font color="#6425d0">Браузер проверяет ответ на основной запрос</font>:
	- Браузер снова проверяет Access-Control-Allow-Origin.
	- Если он совпадает с доменом клиента, данные передаются JavaScript.
	- Если нет, ответ блокируется.