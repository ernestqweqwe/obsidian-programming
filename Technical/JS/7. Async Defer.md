	## Атрибуты `async` и `defer` для тега `<script>`

### `async`
- **Загрузка**: Скрипты загружаются асинхронно, параллельно с парсингом HTML.
- **Выполнение**: Выполняются сразу после загрузки, прерывая парсинг HTML.
- **Порядок выполнения**: Не гарантируется (выполняется в порядке завершения загрузки).
- **Особенности**:
  - Не ждут завершения парсинга HTML или других скриптов.
  - Могут выполняться до формирования полного DOM.
- **Использование**: Подходит для независимых скриптов, не требующих доступа к DOM или другим скриптам (например, аналитика, трекеры).

### `defer`
- **Загрузка**: Скрипты загружаются асинхронно, параллельно с парсингом HTML.
- **Выполнение**: Выполняются только после завершения парсинга HTML, перед событием `DOMContentLoaded`.
- **Порядок выполнения**: Сохраняется (в порядке, указанном в HTML).
- **Особенности**:
  - Ждут завершения парсинга HTML, но не загрузки других ресурсов (например, изображений).
  - Гарантируют доступ к полному DOM.
- **Использование**: Подходит для скриптов, которым нужен готовый DOM или определенный порядок выполнения (например, инициализация UI, библиотеки).

### Дополнения
- **Без атрибутов**: Если у тега `<script>` нет `async` или `defer`, скрипт загружается и выполняется синхронно, блокируя парсинг HTML до завершения.
- **Комбинирование**: 
  - `async` и `defer` вместе не рекомендуется, так как поведение зависит от браузера (обычно `async` имеет приоритет).
  - `async` игнорирует порядок в HTML, тогда как `defer` его сохраняет.
- **Динамические скрипты**: При добавлении скриптов через JavaScript (например, `document.createElement('script')`):
  - По умолчанию они ведут себя как `async`.
  - Можно явно установить `script.async = false` для поведения,类似ного `defer`.
- **Совместимость**: Оба атрибута поддерживаются всеми современными браузерами. Для старых браузеров (например, IE9 и ниже) `defer` может не работать с динамическими скриптами.
- **Оптимизация**:
  - Используйте `async` для независимых скриптов, чтобы минимизировать задержки.
  - Используйте `defer` для скриптов, зависящих от DOM или других скриптов.
  - Размещайте `<script>` в конце `<body>` для синхронных скриптов, чтобы избежать блокировки рендеринга.

### Сравнительная таблица

	| Характеристика            | `async`                     | `defer`                     | Без атрибутов              |
	|---------------------------|-----------------------------|-----------------------------|----------------------------|
	| Загрузка                  | Асинхронная                | Асинхронная                | Синхронная                |
	| Выполнение                | Сразу после загрузки       | После парсинга HTML        | Сразу после загрузки       |
	| Порядок выполнения        | Не гарантирован            | Сохраняется                | Сохраняется                |
	| Блокировка парсинга HTML  | Прерывает при выполнении   | Не блокирует               | Блокирует                 |
	| Доступ к DOM              | Не гарантирован            | Гарантирован               | Зависит от положения       |
	| Примеры использования     | Аналитика, реклама         | UI-логика, библиотеки      | Устаревший подход          |

### Иллюстрация поведения

![[Pasted image 20250620090252.png]]